# Yomikoe（読み声）

Cartesia TTS API を使ってテキストから自然な音声を生成するデスクトップアプリです。
AI による感情アノテーション機能を使うと、嬉しい・悲しい・驚きなどの感情を自動で付けた、表現力豊かな音声を生成できます。

## 必要なもの

- **Cartesia API Key**（必須） — 音声を生成するために必要です
- **Anthropic API Key**（任意） — 感情アノテーション機能を使う場合に必要です

## はじめかた

### 1. Cartesia API Key を取得する

1. [play.cartesia.ai/keys](https://play.cartesia.ai/keys) にアクセスします
2. アカウントを作成またはログインします
3. 「Create API Key」をクリックして API キーを作成します
4. 表示されたキー（`sk-...` の形式）をコピーしておきます

### 2. アプリを起動して設定を開く

アプリを起動すると、左サイドバーに「音声生成」と「設定」の 2 つのメニューがあります。
まず「**設定**」を開きます。

### 3. API キーを入力する

「API キー」セクションで、手順 1 でコピーした Cartesia API Key を入力します。

### 4. ボイスモデルを追加する

「ボイスモデル」セクションで「**モデルを追加**」ボタンを押し、以下の情報を入力します。

#### モデル名

自由に名前を付けてください。キャラクター名や用途で区別すると便利です。

例: `ナレーター`、`キャラA`、`男性・落ち着き`

#### Voice ID の取得方法

1. [play.cartesia.ai/voices](https://play.cartesia.ai/voices) にアクセスします
2. 使いたい声を検索します（日本語対応の声を探すには「Japanese」で絞り込みます）
3. 声の右上にある **⋯**（三点リーダー）をクリックします
4. 「**Copy ID**」を選択します
5. コピーされた ID（`a0e99841-438c-4a64-b679-ae501e7d6091` のような形式）をアプリの Voice ID 欄に貼り付けます

#### アノテーション指示（任意）

AI に「どんな感情で読んでほしいか」を伝える指示文です。空欄のままでもデフォルトの指示が使われます。

例:
- `元気で明るいトーンで読んでください`
- `落ち着いたナレーション風に、感情は控えめにしてください`
- `アニメキャラクターのように感情豊かに読んでください`

入力が終わったら「**追加**」ボタンを押します。
モデルは複数登録でき、音声生成時に切り替えて使えます。

### 5. 音声出力の設定（必要に応じて）

| 設定 | 説明 | 選択肢 |
|---|---|---|
| 音声エンジン | Cartesia の TTS モデル | `sonic-2`（安定）/ `sonic-3`（最新） |
| 言語 | 生成する音声の言語 | `日本語` / `English` |
| サンプルレート | 音質の設定 | `22050 Hz`（軽量）/ `44100 Hz`（高音質） |

### 6. 設定を保存する

ページ下部の「**保存**」ボタンを押して設定を保存します。
設定はアプリを終了しても保持されます。

## 音声を生成する

左サイドバーの「**音声生成**」を開きます。

### 手順

1. **ボイスモデルを選ぶ** — ドロップダウンから、設定画面で追加したモデルを選択します
2. **テキストを入力する** — 読み上げたいテキストをテキストエリアに入力します
3. **「生成」ボタンを押す** — 音声の生成が始まります（テキストの長さによって数秒〜数十秒かかります）
4. **生成完了** — 生成履歴に表示されます

ボイスモデルが未登録の場合は「設定画面でモデルを追加してください」と表示されます。
先に設定画面でモデルを追加してください。

## 感情アノテーション機能

感情アノテーションを有効にすると、入力テキストを AI（Claude）が分析し、適切な感情タグを自動で付けてから音声を生成します。これにより、棒読みではない自然で表現力豊かな音声になります。

### 有効にする方法

1. 「**設定**」画面を開きます
2. 「**感情アノテーション**」チェックボックスをオンにします
3. 表示される「Anthropic API Key」欄に API キーを入力します
   - [console.anthropic.com](https://console.anthropic.com/) から取得できます
4. 「**保存**」を押します

### 感情アノテーションの仕組み

```
入力テキスト
  → Claude が感情を分析（嬉しい、悲しい、驚き、怒り など）
  → 感情タグ付きテキストに変換
  → Cartesia TTS で音声生成
```

例:

```
入力:  「やったー！合格した！」
変換後: <happy, speed:1.0>やったー！合格した！</happy>
```

ボイスモデルごとに「アノテーション指示」をカスタマイズすることで、同じテキストでもキャラクターに合った読み方にできます。

## 開発者向け

### 起動

```bash
pnpm -F @cartesia-download/desktop dev
```

### ビルド

```bash
pnpm -F @cartesia-download/desktop build
```

### デバッグ

開発モード中に **F12** キーで Chrome DevTools を開けます。

## 技術スタック

- [Electron](https://www.electronjs.org/) — デスクトップアプリフレームワーク
- [React](https://react.dev/) + [Jotai](https://jotai.org/) — UI + 状態管理
- [React Aria Components](https://react-spectrum.adobe.com/react-aria/) — アクセシブルな UI コンポーネント
- [Hono](https://hono.dev/) — メイン↔レンダラー間の型安全 IPC
- [Tailwind CSS](https://tailwindcss.com/) v4 — スタイリング
- [@cartesia-download/core](../../packages/core/) — TTS・アノテーション共通ライブラリ
